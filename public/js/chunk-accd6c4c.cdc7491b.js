(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-accd6c4c"],{"0a6f":function(t,e,a){},b3e4:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("CRow",[a("CCol",{attrs:{md:"8"}},[a("CCard",{staticClass:"card-style"},[a("CCardBody",[a("div",[a("div",{staticClass:"input-group mb-2"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.searchField,expression:"searchField"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Search for a medicine...","aria-label":"Search for..."},domProps:{value:t.searchField},on:{keyup:function(e){return t.search()},input:function(e){e.target.composing||(t.searchField=e.target.value)}}})])]),a("CCardBody",[a("CRow",{staticClass:"justify-content-between"},t._l(t.searchResults,(function(e,s){return a("div",{key:s,staticClass:"card mb-3",staticStyle:{"max-width":"30%","min-width":"30%"},attrs:{md:"6"}},[a("div",{staticClass:"card-body"},[a("h4",{staticClass:"card-title"},[t._v(" "+t._s(e.medicine.name)+" ")]),a("CListGroup",[a("CListGroupItem",[t._v(t._s(e.storage))]),a("CListGroupItem",[t._v(t._s(e.medicine.size+e.medicine.unit.short_name))]),a("CListGroupItem",[t._v(t._s(e.remaining_quantity))])],1)],1),a("div",{staticClass:"bg-transparent"},[a("CButton",{staticClass:"col",attrs:{variant:"outline",color:"success"},on:{click:function(a){return t.addtoCart(e)}}},[a("CIcon",{attrs:{name:"cil-cart"}}),t._v(" Add to Cart ")],1)],1)])})),0)],1)],1)],1)],1),a("CCol",{attrs:{md:"4"}},[a("CCard",{staticStyle:{height:"55vh","overflow-y":"auto"},attrs:{id:"element-to-print"}},[a("CCardBody",[a("CRow",{staticClass:"d-flex justify-content-between"},[a("h4",{staticClass:"card-title mb-0 ml-2",attrs:{id:"traffic"}},[t._v(" Reciept "+t._s(t.recieptFor)+" ")])]),a("hr",{staticStyle:{"margin-top":"0px"}}),a("div",{staticClass:"list-group list-group-flush"},[a("CRow",[a("CCol",{staticStyle:{"font-weight":"bold"},attrs:{md:"6"}},[t._v("Drug Name")]),a("CCol",{staticStyle:{"font-weight":"bold"},attrs:{md:"4"}},[t._v("Quantity")]),a("CCol",{staticStyle:{"font-weight":"bold"},attrs:{md:"2"}},[t._v("Amount(Rs.)")])],1),t._l(t.localCart,(function(e,s){return a("CRow",{key:s,staticClass:"list-group-item justify-content-between d-flex",class:{"is-success":e===t.selected},staticStyle:{padding:"5px 1px"},on:{click:function(a){return t.selectingFunc(e)}}},[a("CCol",{staticClass:"text-left",attrs:{md:"6"}},[a("span",[t._v(t._s(e.name+" "+e.size))])]),a("CCol",{attrs:{md:"4"}},[a("span",[a("CButton",{staticClass:"p-0",attrs:{color:"success",shape:"pill",variant:"outline"},on:{click:function(a){return t.getQtyFunction(e,s,"min")}}},[a("CIcon",{staticStyle:{width:"1.5rem"},attrs:{name:"cil-minus"}})],1),t._v(" "),a("span",[t._v(t._s(t.getQty(e)))]),t._v(" "),a("CButton",{staticClass:"p-0",attrs:{color:"success",shape:"pill",variant:"outline"},on:{click:function(a){return t.getQtyFunction(e,s,"plus")}}},[a("CIcon",{staticStyle:{width:"1.5rem"},attrs:{name:"cil-plus"}})],1)],1)]),a("CCol",{attrs:{md:"2"}},[a("CRow",{staticStyle:{float:"right"}},[a("span",{staticClass:"mr-1",class:{"is-success":e===t.selected}},[t._v(t._s(t.getPrice(e)))]),a("span",[a("button",{staticClass:"btn btn-danger p-1",attrs:{id:"btn"+s,color:"danger",variant:"outline"},on:{click:function(a){return t.remove(e,a)}}},[a("CIcon",{staticStyle:{"pointer-events":"none"},attrs:{name:"cil-delete"}})],1)])])],1)],1)}))],2)],1)],1),a("CCard",{staticStyle:{height:"20vh"}},[a("CCardBody",{staticClass:"d-flex flex-direction-column justify-content-between"},[a("CCol",{staticClass:"d-flex justify-content-between",staticStyle:{"flex-basis":"auto"}},[a("h2",{staticClass:"card-title mb-0 ml-2",attrs:{id:"traffic"}},[t._v("Total")]),a("CSelect",{attrs:{options:t.options,id:"medSelect"},on:{change:function(e){return t.changeMethod(e)}},model:{value:t.method,callback:function(e){t.method=e},expression:"method"}}),a("div",{staticClass:"total mr-2",staticStyle:{"align-self":"flex-end"}},[t._v(" Rs. "+t._s(t.total)+" ")])],1),a("hr",{staticStyle:{"margin-bottom":"35px","margin-top":"10px"}}),a("CRow",{staticClass:"bg-transparent"},[a("CButton",{staticClass:"col",attrs:{variant:"outline",color:"danger"},on:{click:function(e){return t.clearCart()}}},[a("CIcon",{attrs:{name:"cil-delete"}}),t._v(" Clear ")],1),a("CButton",{staticClass:"col",attrs:{variant:"outline",color:"success"},on:{click:function(e){return t.submit(e)}}},[a("CIcon",{attrs:{name:"cil-check-circle"}}),t._v(" Proceed ")],1)],1)],1)],1)],1)],1)},i=[],n=a("2ef0"),r=a.n(n),o=a("c1df"),c=a.n(o);function l(t,e,a,s,i,n,r){try{var o=t[n](r),c=o.value}catch(l){return void a(l)}o.done?e(c):Promise.resolve(c).then(s,i)}function u(t){return function(){var e=this,a=arguments;return new Promise((function(s,i){var n=t.apply(e,a);function r(t){l(n,s,i,r,o,"next",t)}function o(t){l(n,s,i,r,o,"throw",t)}r(void 0)}))}}var h={name:"Cashier",data:function(){return{searchResults:[],price:Number,cart:[],localCart:[],options:["Cash","Card"],method:"Cash",total:0,searchField:"",row:{},recieptFor:"",selected:{}}},created:function(){var t=this;window.addEventListener("keydown",(function(e){"+"==e.key&&t.getQtyFunction(t.selected,1,"plus")})),window.addEventListener("keydown",(function(e){"-"==e.key&&t.getQtyFunction(t.selected,1,"min")}))},mounted:function(){this.getData(),this.$route.params.row&&(console.log(this.$route.params.row),this.recieptFor="for "+this.$route.params.row.customer.firstname,this.row=this.$route.params.row)},methods:{changeMethod:function(t){this.method=t.target.value},search:function(){var t=this;this.searchField?this.$http.get("http://localhost:3000/batch/batch_search/"+this.searchField).then((function(e){t.searchResults=e.data})).catch((function(t){console.log(t.response)})):this.getData()},submit:function(t){var e=this;t.preventDefault(),console.log(this.method),this.$route.params.row?(this.formData={customer:this.row.customer._id,total:this.total,list:this.localCart,user:sessionStorage.getItem("user")},0!=this.localCart.length?(console.log(this.localCart),this.$http.put("http://localhost:3000/onlineOrder/cashier/"+this.row._id,this.formData).then((function(t){e.$swal.fire("Done!","Transaction Completed!","success"),e.localCart=[],e.total=0,e.$route.params={},e.recieptFor="",e.getData(),e.row={}})).catch((function(t){console.log(t.response)}))):this.$swal.fire("No items in cart","Check the cart again.","error")):(this.formData={total:this.total,items:this.localCart,method:this.method,user:sessionStorage.getItem("user")},0!=this.localCart.length?(console.log(this.localCart),this.$http.post("http://localhost:3000/sales/post",this.formData).then((function(t){e.$swal.fire("Done!","Order is submitted!","success"),e.localCart=[],e.total=0,e.getData()})).catch((function(t){console.log(t),console.log(t.response)}))):this.$swal.fire("No items in cart","Check the cart again.","error"))},getPrice:function(t){return t.price},clearCart:function(){this.localCart=[],this.total=0},getname:function(t,e){var a=t.indexOf("[");return-1===a?"Not Mentioned":"["+t.split("[")[1]+e},getQty:function(t){return t.qty},getQtyFunction:function(t,e,a){if("plus"==a){if(parseInt(t.Remainingqty)>=t.qty+1)return t.price=parseFloat(t.price)+parseFloat(t.selling_price),this.total=this.total+parseFloat(t.selling_price),t.qty++}else{if("min"!=a)return 1;if(parseInt(t.qty)>=2)return t.price=parseFloat(t.price)-parseFloat(t.selling_price),this.total=this.total-parseFloat(t.selling_price),t.qty--}},getData:function(){var t=this;return u(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$http.get("http://localhost:3000/batch/get").then((function(e){var a=[];e.data.forEach((function(t){var e=c()(t.expiry_date),s=c()().startOf("day"),i=c.a.duration(e.diff(s)).asDays();0==t.remaining_quantity||i<=30||a.push(t)})),t.searchResults=a,console.log(e.data)})).catch((function(e){console.log(e.response),401==e.response.status&&t.$store.dispatch("logout").then((function(){}))}));case 2:case"end":return e.stop()}}),e,this)})))()},addtoCart:function(t){var e=c()(t.expiry_date),a=c()().startOf("day"),s=c.a.duration(e.diff(a)).asDays();if(s<=30)this.$swal.fire("This item has only "+String(s).split(".")[0]+" days before expiring.","","error");else{var i={};0!=this.localCart.length&&this.localCart.filter((function(e){return e.name===t.medicine.name})).length>0?this.$swal.fire("Item already in the Cart!"):this.cartFunction(i,t)}},cartFunction:function(t,e){t.name=e.medicine.name,t.size=e.medicine.size,t.qty=1,t.Remainingqty=e.remaining_quantity,t.price=e.selling_price,t.selling_price=e.selling_price,t.id=e._id,this.localCart.push(t),this.total=this.total+parseFloat(e.selling_price),this.cart.push(e)},remove:function(t){r.a.remove(this.localCart,(function(e){return e.name===t.name})),this.total=this.total-t.price},selectingFunc:function(t){this.selected=t}}},d=h,p=(a("b585"),a("2877")),m=Object(p["a"])(d,s,i,!1,null,"833df974",null);e["default"]=m.exports},b585:function(t,e,a){"use strict";var s=a("0a6f"),i=a.n(s);i.a}}]);
//# sourceMappingURL=chunk-accd6c4c.cdc7491b.js.map